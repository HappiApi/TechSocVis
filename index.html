<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Page Template</title>
        <script type="text/javascript" src="d3/d3.min.js"></script>
        <style>
            #date {
                display: inline-block;
                position: fixed;
                z-index: 10;
                top: 50px;
                right: 50px;

            }
        </style>
    </head>
    <body>
        <div id="illus">
            <div id="date">
                <h1></h1>
            </div>
        </div>
        <script type="text/javascript">
            // Your beautiful D3 code will go here

            var memberData;
            var eventData;
            var margin = {
                            top: 50,
                            right: 50,
                            bottom: 50,
                            left: 50
                        }

            var fullHeight = 500;
            var fullWidth = 1000;
            var height = fullHeight - (margin.top + margin.bottom);
            var width = fullWidth - (margin.right + margin.left);

            d3.csv("membership.csv", function(e,r){
                memberData = r;

                d3.json("events.json", function(e,r){
                    eventData = r;
                    visualization();
                })
            })

            function visualization() {

                var memberChart = d3.select("#illus").append("svg")
                                .attr("height", fullHeight)
                                .attr("width", fullWidth) 
                                .append("g")
                                .attr("height", height)
                                .attr("width", width) 
                                .attr("transform", "translate("+margin.left+","+margin.top+")")
                                .style("opacity", 1)    

                var pixelTicks = 10;
                var baseTime = new Date(2015, 08, 26);
                var currentTime = new Date(2015, 08, 26);
                var msPerDay = 86400000;
                var body = d3.select("body").node();

                function init() {
                    d3.select("#date h1").text(currentTime.toDateString());
                }

                init();  

                function getTicks() {
                    return Math.floor(body.scrollTop/pixelTicks)
                }

                function updateTime() {
                    currentTime.setTime(baseTime.getTime() + getTicks() * msPerDay);
                    console.log(currentTime, baseTime, getTicks(), body.scrollTop);

                }

                function updateGraphic() {
                    d3.select("#date h1").text(currentTime.toDateString());
                }

                function tick() {
                    updateTime();
                    updateGraphic();
                }

                d3.select(window)
                    .on("scroll.scroller", tick);


            }

        </script>
    </body>
</html>